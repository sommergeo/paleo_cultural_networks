rm(periods)
# Statistics for subsets
stats_cultures <- data_cultures %>% group_by(connection) %>%
summarize(median_dist=median(dist),
mean_dist=mean(dist),
sd_dist=sd(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
sd_jaccard=sd(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
# Statistics for subsets
stats_periods <- data_periods %>% group_by(connection) %>%
summarize(median_dist=median(dist),
mean_dist=mean(dist),
sd_dist=sd(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
sd_jaccard=sd(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
View(stats_cultures)
View(stats_periods)
write_csv(data_periods, 'work/periods_edges.csv')
write_csv(data_cultures, 'work/cultures_edges.csv')
write_csv(data_cultures, 'work/cultures_edges.csv')
write_csv(stats_periods, 'work/stats_selected_periods.csv')
write_csv(stats_cultures, 'work/stats_selected_cultures.csv')
View(stats_periods)
View(stats_cultures)
data_cultures <- data %>%
mutate(
connection=case_when(
culture.A %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') & culture.B %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') ~ 'African Acheulean',
culture.A %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') & culture.B %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') ~ 'Levantine Acheulean',
culture.A == 'Acheulean - Europe' & culture.B == 'Acheulean - Europe' ~ 'European Acheulean',
culture.A == 'Howiesonspoort' & culture.B == 'Howiesonspoort' ~ 'Howiesons Poort',
culture.A == 'Aterian' & culture.B == 'Aterian' ~ 'Aterian',
culture.A == 'Micoquian' & culture.B == 'Micoquian' ~ 'Micoquian',
culture.A == 'ELSA' & culture.B == 'ELSA' ~ 'Early Later Stone Age',
culture.A == 'Gravettian' & culture.B == 'Gravettian' ~ 'Gravettian',
culture.A == 'Initial Upper Paleolithic - Eurasia' & culture.B == 'Initial Upper Paleolithic - Eurasia' ~ 'Initial Upper Paleolithic'
)) %>%
mutate(connection = factor(connection, levels = c('African Acheulean', 'Levantine Acheulean', 'European Acheulean', 'Howiesons Poort', 'Aterian', 'Micoquian', 'Early Later Stone Age', 'Gravettian', 'Initial Upper Paleolithic'))) %>%
filter(!is.na(connection))
library(tidyverse)
library(sf)
data <- readRDS('work/lor7.rds') %>% select(-c(geometry, opacity))
## Subset data
data_periods <- data %>% filter(cultural_period.A %in% c('MSA','Middle Paleolithic') & cultural_period.B %in% c('MSA','Middle Paleolithic')) %>%
mutate(
connection=case_when(
cultural_period.A == 'MSA' & cultural_period.B == 'MSA' ~ 'Middle Stone Age',
cultural_period.A == 'Middle Paleolithic' & cultural_period.B == 'Middle Paleolithic' ~ 'Middle Paleolithic',
cultural_period.A != cultural_period.B ~ 'Between MSA and MP'
))
data_cultures <- data %>%
mutate(
connection=case_when(
culture.A %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') & culture.B %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') ~ 'African Acheulean',
culture.A %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') & culture.B %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') ~ 'Levantine Acheulean',
culture.A == 'Acheulean - Europe' & culture.B == 'Acheulean - Europe' ~ 'European Acheulean',
culture.A == 'Howiesonspoort' & culture.B == 'Howiesonspoort' ~ 'Howiesons Poort',
culture.A == 'Aterian' & culture.B == 'Aterian' ~ 'Aterian',
culture.A == 'Micoquian' & culture.B == 'Micoquian' ~ 'Micoquian',
culture.A == 'ELSA' & culture.B == 'ELSA' ~ 'Early Later Stone Age',
culture.A == 'Gravettian' & culture.B == 'Gravettian' ~ 'Gravettian',
culture.A == 'Initial Upper Paleolithic - Eurasia' & culture.B == 'Initial Upper Paleolithic - Eurasia' ~ 'Initial Upper Paleolithic'
)) %>%
mutate(connection = factor(connection, levels = c('African Acheulean', 'Levantine Acheulean', 'European Acheulean', 'Howiesons Poort', 'Aterian', 'Micoquian', 'Early Later Stone Age', 'Gravettian', 'Initial Upper Paleolithic'))) %>%
filter(!is.na(connection))
ggplot(data=data_cultures)+
geom_point(aes(x=dist, y=jaccard, color=connection))+
facet_wrap(.~connections)
ggplot(data=data_cultures)+
geom_point(aes(x=dist, y=jaccard, color=connection))+
facet_wrap(.~connection)
ggplot(data=data_cultures)+
#geom_point(aes(x=dist, y=jaccard))+
geom_bin2d(aes(x=dist, y=jaccard))+
facet_wrap(.~connection)
ggplot(data=data_cultures)+
geom_point(aes(x=dist, y=jaccard), alpha=.05)+
facet_wrap(.~connection)
ggplot(data=data_cultures)+
#geom_point(aes(x=dist, y=jaccard), alpha=.05)+
geom_raster(aes(x=dist, y=jaccard))+
facet_wrap(.~connection)
ggplot(data=data_cultures)+
#geom_point(aes(x=dist, y=jaccard), alpha=.05)+
geom_bin2d(aes(x=dist, y=jaccard), binwidth = c(0.25, 500))+
facet_wrap(.~connection)
ggplot(data=data_cultures)+
geom_point(aes(x=dist, y=jaccard), alpha=.05)+
scale_x_log10()+
facet_wrap(.~connection)
ggplot(data=data_cultures)+
geom_point(aes(x=dist, y=jaccard), alpha=.05)+
facet_wrap(.~connection)
ggplot(data=data_periods)+
geom_point(aes(x=dist, y=jaccard), alpha=.05)+
facet_wrap(.~connection)
ggplot(data=data_cultures)+
geom_point(aes(x=dist, y=jaccard), alpha=.05)+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
theme_light()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_point(aes(x=dist, y=jaccard), alpha=.05)+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_light()+
theme(text=element_text(size=10))
cor(data_cultures$dist, data_cultures$jaccard)
ggplot(data=data_cultures)+
geom_point(aes(x=dist, y=jaccard), alpha=.05)+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_point(aes(x=dist, y=jaccard), alpha=.01)+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_point(aes(x=dist, y=jaccard), size=1, alpha=.01)+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(0.25, 500))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(0.25, 500))+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard))+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(1000, 0.125))+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(1000, 0.5))+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(1000000, 0.125))+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(500000, 0.125))+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(500000, 0.1))+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(500000, 0.05))+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(500000, 0.1))+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(250000, 0.1))+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(500000, 0.1))+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(500000, 0.1), drop=F)+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(500000, 0.1), drop=T)+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(500000, 0.1), drop=F)+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures)+
geom_bin2d(aes(x=dist, y=jaccard),binwidth = c(500000, 0.1), drop=T)+
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = T) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
scale_fill_distiller(palette=4, direction=-1) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
scale_fill_distiller(palette=4, direction=1) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
scale_fill_distiller(palette=4, direction=1) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000, limits=c(0,8000))+
scale_y_continuous(limits=c(0,1))+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
scale_fill_distiller(palette=4, direction=1) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000, limits=c(0,8000000))+
scale_y_continuous(limits=c(0,1))+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
scale_fill_distiller(palette=4, direction=1) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000, limits=c(0,80000000))+
scale_y_continuous(limits=c(0,1))+
theme_classic()+
theme(text=element_text(size=10))
warnings()
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
scale_fill_distiller(palette=4, direction=1) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000, limits=c(0,8000000))+
scale_y_continuous(limits=c(0,1))+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
scale_fill_distiller(palette=4, direction=1) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
scale_fill_distiller(palette=4, direction=1) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
#scale_fill_distiller(palette=4, direction=1) +
scale_fill_gradient(low = "#771C19", high = "#000000")
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#771C19", high = "#000000")+
theme_classic()+
theme(text=element_text(size=10))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37")+
theme_classic()+
theme(text=element_text(size=10))
data_cultures <- data %>%
mutate(
connection=case_when(
culture.A %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') & culture.B %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') ~ 'African Acheulean',
culture.A %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') & culture.B %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') ~ 'Levantine Acheulean',
culture.A == 'Acheulean - Europe' & culture.B == 'Acheulean - Europe' ~ 'European Acheulean',
culture.A == 'Howiesonspoort' & culture.B == 'Howiesonspoort' ~ 'Howiesons Poort',
culture.A == 'Aterian' & culture.B == 'Aterian' ~ 'Aterian',
culture.A == 'Micoquian' & culture.B == 'Micoquian' ~ 'Micoquian',
culture.A == 'ELSA' & culture.B == 'ELSA' ~ 'Early Later Stone Age',
culture.A == 'Gravettian' & culture.B == 'Gravettian' ~ 'Gravettian',
culture.A == 'Initial Upper Paleolithic - Eurasia' & culture.B == 'Initial Upper Paleolithic - Eurasia' ~ 'Initial Upper Paleolithic'
)) %>%
mutate(connection = factor(connection, levels = c('Early Later Stone Age', 'Gravettian', 'Initial Upper Paleolithic', 'Howiesons Poort', 'Aterian', 'Micoquian','African Acheulean', 'Levantine Acheulean', 'European Acheulean'))) %>%
filter(!is.na(connection))
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37")+
theme_classic()+
theme(text=element_text(size=10))
# Plot Semivariogram
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37")+
theme_classic()+
theme(text=element_text(size=10),
panel.background = element_rect(fill = "white", colour = "white"))
# Plot Semivariogram
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37")+
theme_classic()+
theme(text=element_text(size=10),
panel.strip = element_rect(fill = "white", colour = "white"))
# Plot Semivariogram
ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37")+
theme_classic()+
theme(text=element_text(size=10),
strip.background = element_rect(fill = "white", colour = "white"))
data_selected <- rbind(data_periods, data_cultures)
# Plot Semivariogram
ggplot(data=data_selected, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity (Jaccard)", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37")+
theme_classic()+
theme(text=element_text(size=10),
strip.background = element_rect(fill = "white", colour = "white"))
unique(data_selected$connection)
data_selected <- rbind(data_periods, data_cultures) %>% mutate(connection = factor(connection, levels = c('Early Later Stone Age', 'Gravettian', 'Initial Upper Paleolithic', 'Howiesons Poort', 'Aterian', 'Micoquian','African Acheulean', 'Levantine Acheulean', 'European Acheulean'))) %>%
# Statistics for subsets
stats_periods <- data_periods %>% group_by(connection) %>%
summarize(median_dist=median(dist),
mean_dist=mean(dist),
sd_dist=sd(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
sd_jaccard=sd(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
View(data_selected)
write_csv(data_selected, 'work/selected_cultures_and_periods_edges.csv')
saveRDS(data_selected, 'work/selected_cultures_and_periods')
# Plot heatmap ----
ggplot(data=data_selected, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity [Jaccard Index]", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37", name='Density')+
theme_classic()+
theme(text=element_text(size=10),
strip.background = element_rect(fill = "white", colour = "white"))
# Plot heatmap ----
plt1 <- ggplot(data=data_periods, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity [Jaccard Index]", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37", name='Density')+
theme_classic()+
theme(text=element_text(size=10),
strip.background = element_rect(fill = "white", colour = "white"))
plt1
plt2 <- ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection)+
labs(x=bquote('Distance [km]'), y = "Similarity [Jaccard Index]", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37", name='Density')+
theme_classic()+
theme(text=element_text(size=10),
strip.background = element_rect(fill = "white", colour = "white"))
plt2
plt2 <- ggplot(data=data_cultures, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection, scales='free_x')+
labs(x=bquote('Distance [km]'), y = "Similarity [Jaccard Index]", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37", name='Density')+
theme_classic()+
theme(text=element_text(size=10),
strip.background = element_rect(fill = "white", colour = "white"))
plt2
library(cowplot)
plt_combined <- plot_grid(plt1, plt2, align='v', nrow=2, labels=c('A Cultural periods', 'B Cultures'))
plt_combined <- plot_grid(plt1, plt2, align='v', axis='lr', nrow=2, labels=c('A Cultural periods', 'B Cultures'), label_size=12)
data_selected <- rbind(data_periods, data_cultures) %>% mutate(connection = factor(connection, levels = c('Middle Stone Age', 'Between MSA and MP', 'Middle Paleolithic', 'Early Later Stone Age', 'Gravettian', 'Initial Upper Paleolithic', 'Howiesons Poort', 'Aterian', 'Micoquian','African Acheulean', 'Levantine Acheulean', 'European Acheulean')))
# Plot heatmap ----
plt1 <- ggplot(data=data_selected, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection, scales='free_x')+
labs(x=bquote('Distance [km]'), y = "Similarity [Jaccard Index]", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37", name='Density')+
theme_classic()+
theme(text=element_text(size=10),
strip.background = element_rect(fill = "white", colour = "white"))
plt1
# Plot heatmap ----
plt1 <- ggplot(data=data_selected, aes(x=dist, y=jaccard))+
stat_density_2d(aes(fill = ..density..), geom = "raster", contour = F) +
facet_wrap(.~connection, scales='free_x', ncol=3)+
labs(x=bquote('Distance [km]'), y = "Similarity [Jaccard Index]", caption = "") +
scale_x_continuous(labels=function(x)x/1000)+
scale_fill_gradient(low = "#f4e8e5", high = "#a51e37", name='Density')+
theme_classic()+
theme(text=element_text(size=10),
strip.background = element_rect(fill = "white", colour = "white"))
plt1
ggsave("results/fig_3.tiff", units="cm", width=18, height=18, dpi=300)
ggsave("results/fig_3.eps", units="cm", width=18, height=18, dpi=300)
ggsave("results/fig_3.png", units="cm", width=18, height=18, dpi=300)
rm(plt2)
