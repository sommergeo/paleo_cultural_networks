library(tidyverse)
library(sf)
data <- readRDS('work/lor7.rds') %>% select(-geometry)
cultures <- data %>% filter(culture.A==culture.B) #%>%
cultures <- data %>% filter(culture.A==culture.B) %>%
)
cultures <- data %>% filter(culture.A==culture.B) %>%
group_by(culture.A) %>%
summarize(median_dist=median(dist),
mean_dist=mean_dist(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=median(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
cultures <- data %>% filter(culture.A==culture.B) %>%
group_by(culture.A) %>%
summarize(median_dist=median(dist),
mean_dist=mean(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
View(cultures)
count
count(cultures)
periods <- data %>% filter(cultural_period.A==cultural_period.B) %>%
group_by(cultural_period.A) %>%
summarize(n_edges=count(),
median_dist=median(dist),
mean_dist=mean(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
periods <- data %>% filter(cultural_period.A==cultural_period.B) %>%
group_by(cultural_period.A) %>%
summarize(n_edges=count(.drop=F),
median_dist=median(dist),
mean_dist=mean(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
periods <- data %>% filter(cultural_period.A==cultural_period.B) %>%
group_by(cultural_period.A) %>%
summarize(n_edges=count(.drop=T),
median_dist=median(dist),
mean_dist=mean(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
unique(data$cultural_period.A)
periods <- data %>% filter(cultural_period.A==cultural_period.B) %>%
group_by(cultural_period.B) %>%
summarize(n_edges=count(.drop=T),
median_dist=median(dist),
mean_dist=mean(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
periods <- data %>% filter(cultural_period.A==cultural_period.B) %>%
group_by(cultural_period.A) %>%
summarize(n_edges=count(cultural_period.A),
median_dist=median(dist),
mean_dist=mean(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
periods <- data %>% filter(cultural_period.A==cultural_period.B) %>% filter(cultural_period.A!='-')
periods <- data %>% filter(cultural_period.A==cultural_period.B) %>% filter(cultural_period.A!='-') %>%
group_by(cultural_period.A) %>%
summarize(n_edges=count(cultural_period.A),
median_dist=median(dist),
mean_dist=mean(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
periods <- data %>% filter(cultural_period.A==cultural_period.B) %>%
group_by(cultural_period.A) %>%
summarize(median_dist=median(dist),
mean_dist=mean(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
View(periods)
cultures <- data %>% filter(culture.A==culture.B) %>%
group_by(culture.A) %>%
summarize(median_dist=median(dist),
mean_dist=mean(dist),
sd_dist=sd(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
sd_jaccard=sd(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
getwd()
write_csv(cultures, 'work/stats_cultures.csv')
periods <- data %>% filter(cultural_period.A==cultural_period.B) %>%
group_by(cultural_period.A) %>%
summarize(median_dist=median(dist),
mean_dist=mean(dist),
sd_dist=sd(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
sd_jaccard=sd(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
write_csv(periods, 'work/stats_periods.csv')
unique(data$cultural_period.A)
data_periods <- data %>% filter(cultural_period.A %in% c('MSA','Middle Paleolithic'))
View(data_periods)
data_periods <- data %>% filter(cultural_period.A %in% c('MSA','Middle Paleolithic')) %>%
mutate(connection=case_when(
cultural_period.A == 'MSA' $ cultural_period.B == 'MSA' ~ 'Middle Stone Age'
cultural_period.A == 'Middle Paleolithic' $ cultural_period.B == 'Middle Paleolithic' ~ 'Middle Paleolithic'
cultural_period.A != cultural_period.B ~ 'Between MSA and MP'
))
data_periods <- data %>% filter(cultural_period.A %in% c('MSA','Middle Paleolithic')) %>%
mutate(connection=case_when(
cultural_period.A == 'MSA' $ cultural_period.B == 'MSA' ~ 'Middle Stone Age',
cultural_period.A == 'Middle Paleolithic' $ cultural_period.B == 'Middle Paleolithic' ~ 'Middle Paleolithic',
cultural_period.A != cultural_period.B ~ 'Between MSA and MP'
))
data_periods <- data %>% filter(cultural_period.A %in% c('MSA','Middle Paleolithic')) %>%
mutate(connection=case_when(
cultural_period.A == 'MSA' $ cultural_period.B == 'MSA' ~ 'Middle Stone Age',
cultural_period.A == 'Middle Paleolithic' $ cultural_period.B == 'Middle Paleolithic' ~ 'Middle Paleolithic',
cultural_period.A != cultural_period.B ~ 'Between MSA and MP'
)))
)
data_periods <- data %>% filter(cultural_period.A %in% c('MSA','Middle Paleolithic')) %>%
mutate(
connection=case_when(
cultural_period.A == 'MSA' $ cultural_period.B == 'MSA' ~ 'Middle Stone Age',
cultural_period.A == 'Middle Paleolithic' $ cultural_period.B == 'Middle Paleolithic' ~ 'Middle Paleolithic',
cultural_period.A != cultural_period.B ~ 'Between MSA and MP'
))
data_periods <- data %>% filter(cultural_period.A %in% c('MSA','Middle Paleolithic')) %>%
mutate(
connection=case_when(
cultural_period.A == 'MSA' $ cultural_period.B == 'MSA' ~ 'Middle Stone Age',
cultural_period.A == 'Middle Paleolithic' & cultural_period.B == 'Middle Paleolithic' ~ 'Middle Paleolithic',
cultural_period.A != cultural_period.B ~ 'Between MSA and MP'
))
data_periods <- data %>% filter(cultural_period.A %in% c('MSA','Middle Paleolithic')) %>%
mutate(
connection=case_when(
cultural_period.A == 'MSA' & cultural_period.B == 'MSA' ~ 'Middle Stone Age',
cultural_period.A == 'Middle Paleolithic' & cultural_period.B == 'Middle Paleolithic' ~ 'Middle Paleolithic',
cultural_period.A != cultural_period.B ~ 'Between MSA and MP'
))
View(data_periods)
data_periods <- data %>% filter((cultural_period.A & cultural_period.A) %in% c('MSA','Middle Paleolithic')) %>%
mutate(
connection=case_when(
cultural_period.A == 'MSA' & cultural_period.B == 'MSA' ~ 'Middle Stone Age',
cultural_period.A == 'Middle Paleolithic' & cultural_period.B == 'Middle Paleolithic' ~ 'Middle Paleolithic',
cultural_period.A != cultural_period.B ~ 'Between MSA and MP'
))
data_periods <- data %>% filter((cultural_period.A & cultural_period.B) %in% c('MSA','Middle Paleolithic')) %>%
mutate(
connection=case_when(
cultural_period.A == 'MSA' & cultural_period.B == 'MSA' ~ 'Middle Stone Age',
cultural_period.A == 'Middle Paleolithic' & cultural_period.B == 'Middle Paleolithic' ~ 'Middle Paleolithic',
cultural_period.A != cultural_period.B ~ 'Between MSA and MP'
))
data_periods <- data %>% filter(cultural_period.A %in% c('MSA','Middle Paleolithic') & cultural_period.B %in% c('MSA','Middle Paleolithic')) %>%
mutate(
connection=case_when(
cultural_period.A == 'MSA' & cultural_period.B == 'MSA' ~ 'Middle Stone Age',
cultural_period.A == 'Middle Paleolithic' & cultural_period.B == 'Middle Paleolithic' ~ 'Middle Paleolithic',
cultural_period.A != cultural_period.B ~ 'Between MSA and MP'
))
View(data_periods)
unique(data$culture.A)
View(data_periods)
ggplot(data=data_periods)+
geom_point(aes(x=dist, y=jaccard, color=connection))
ggplot(data=data_periods)+
geom_point(aes(x=dist, y=jaccard))+
facet_wrap(.~connection)
library(tidyverse)
library(sf)
data <- readRDS('work/lor7.rds') %>% select(-geometry)
View(data)
data <- readRDS('work/lor7.rds') %>% select(-c(geometry, opacity))
write_csv(cultures, 'work/stats_edges.csv')
write_csv(data, 'work/stats_edges.csv')
data_periods <- data %>% filter(cultural_period.A %in% c('MSA','Middle Paleolithic') & cultural_period.B %in% c('MSA','Middle Paleolithic')) %>%
mutate(
connection=case_when(
cultural_period.A == 'MSA' & cultural_period.B == 'MSA' ~ 'Middle Stone Age',
cultural_period.A == 'Middle Paleolithic' & cultural_period.B == 'Middle Paleolithic' ~ 'Middle Paleolithic',
cultural_period.A != cultural_period.B ~ 'Between MSA and MP'
))
View(data_periods)
ggplot(data=data_periods)+
geom_point(aes(x=dist, y=jaccard, color=connection))
unique(data$culture.A)
data_cultures <- data %>%
mutate(
connection=case_when(
culture.A %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') & culture.B %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') ~ 'African Acheulean',
culture.A %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') & culture.B %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') ~ 'Levantine Acheulean',
culture.A == 'Acheulean - Europe' & culture.B == 'Acheulean - Europe' ~ 'European Acheulean'
))
View(data_cultures)
unique(data_cultures$connection)
data_cultures <- data %>%
mutate(
connection=case_when(
culture.A %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') & culture.B %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') ~ 'African Acheulean',
culture.A %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') & culture.B %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') ~ 'Levantine Acheulean',
culture.A == 'Acheulean - Europe' & culture.B == 'Acheulean - Europe' ~ 'European Acheulean'
culture.A == 'Howiesonspoort' & culture.B == 'Howiesonspoort' ~ 'Howiesons Poort',
culture.A == 'Aterian' & culture.B == 'Aterian' ~ 'Aterian',
culture.A == 'Micoquian' & culture.B == 'Micoquian' ~ 'Micoquian',
culture.A == 'ELSA' & culture.B == 'ELSA' ~ 'Early Later Stone Age',
culture.A == 'Gravettian' & culture.B == 'Gravettian' ~ 'Gravettian',
culture.A == 'Initial Upper Paleolithic - Eurasia' & culture.B == 'Initial Upper Paleolithic - Eurasia' ~ 'Initial Upper Paleolithic'
))
)
data_cultures <- data %>%
mutate(
connection=case_when(
culture.A %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') & culture.B %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') ~ 'African Acheulean',
culture.A %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') & culture.B %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') ~ 'Levantine Acheulean',
culture.A == 'Acheulean - Europe' & culture.B == 'Acheulean - Europe' ~ 'European Acheulean'
culture.A == 'Howiesonspoort' & culture.B == 'Howiesonspoort' ~ 'Howiesons Poort',
culture.A == 'Aterian' & culture.B == 'Aterian' ~ 'Aterian',
culture.A == 'Micoquian' & culture.B == 'Micoquian' ~ 'Micoquian',
culture.A == 'ELSA' & culture.B == 'ELSA' ~ 'Early Later Stone Age',
culture.A == 'Gravettian' & culture.B == 'Gravettian' ~ 'Gravettian',
culture.A == 'Initial Upper Paleolithic - Eurasia' & culture.B == 'Initial Upper Paleolithic - Eurasia' ~ 'Initial Upper Paleolithic'
)))
data_cultures <- data %>%
mutate(
connection=case_when(
culture.A %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') & culture.B %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') ~ 'African Acheulean',
culture.A %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') & culture.B %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') ~ 'Levantine Acheulean',
culture.A == 'Acheulean - Europe' & culture.B == 'Acheulean - Europe' ~ 'European Acheulean',
culture.A == 'Howiesonspoort' & culture.B == 'Howiesonspoort' ~ 'Howiesons Poort',
culture.A == 'Aterian' & culture.B == 'Aterian' ~ 'Aterian',
culture.A == 'Micoquian' & culture.B == 'Micoquian' ~ 'Micoquian',
culture.A == 'ELSA' & culture.B == 'ELSA' ~ 'Early Later Stone Age',
culture.A == 'Gravettian' & culture.B == 'Gravettian' ~ 'Gravettian',
culture.A == 'Initial Upper Paleolithic - Eurasia' & culture.B == 'Initial Upper Paleolithic - Eurasia' ~ 'Initial Upper Paleolithic'
))
View(data_cultures)
data_cultures <- data %>%
mutate(
connection=case_when(
culture.A %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') & culture.B %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') ~ 'African Acheulean',
culture.A %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') & culture.B %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') ~ 'Levantine Acheulean',
culture.A == 'Acheulean - Europe' & culture.B == 'Acheulean - Europe' ~ 'European Acheulean',
culture.A == 'Howiesonspoort' & culture.B == 'Howiesonspoort' ~ 'Howiesons Poort',
culture.A == 'Aterian' & culture.B == 'Aterian' ~ 'Aterian',
culture.A == 'Micoquian' & culture.B == 'Micoquian' ~ 'Micoquian',
culture.A == 'ELSA' & culture.B == 'ELSA' ~ 'Early Later Stone Age',
culture.A == 'Gravettian' & culture.B == 'Gravettian' ~ 'Gravettian',
culture.A == 'Initial Upper Paleolithic - Eurasia' & culture.B == 'Initial Upper Paleolithic - Eurasia' ~ 'Initial Upper Paleolithic'
)) %>%
filter(!is.na(connection))
unique(data_cultures$connection)
data_cultures <- data %>%
mutate(
connection=case_when(
culture.A %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') & culture.B %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') ~ 'African Acheulean',
culture.A %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') & culture.B %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') ~ 'Levantine Acheulean',
culture.A == 'Acheulean - Europe' & culture.B == 'Acheulean - Europe' ~ 'European Acheulean',
culture.A == 'Howiesonspoort' & culture.B == 'Howiesonspoort' ~ 'Howiesons Poort',
culture.A == 'Aterian' & culture.B == 'Aterian' ~ 'Aterian',
culture.A == 'Micoquian' & culture.B == 'Micoquian' ~ 'Micoquian',
culture.A == 'ELSA' & culture.B == 'ELSA' ~ 'Early Later Stone Age',
culture.A == 'Gravettian' & culture.B == 'Gravettian' ~ 'Gravettian',
culture.A == 'Initial Upper Paleolithic - Eurasia' & culture.B == 'Initial Upper Paleolithic - Eurasia' ~ 'Initial Upper Paleolithic'
)) %>%
mutate(connection = factor(connection, levels = c('African Acheulean', 'Levantine Acheulean', 'European Acheulean', 'Howiesons Poort', 'Aterian', 'Micoquian', 'Early Later Stone Age', 'Gravettian', 'Micoquian'))) %>%
filter(!is.na(connection))
data_cultures <- data %>%
mutate(
connection=case_when(
culture.A %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') & culture.B %in% c('Acheulean - Africa', 'Early Acheulean - Africa', 'Middle Acheulean - Africa', 'Late Acheulean - Africa') ~ 'African Acheulean',
culture.A %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') & culture.B %in% c('Acheulean - Levant', 'Early Acheulean - Levant', 'Middle Acheulean - Levant', 'Late Acheulean - Levant') ~ 'Levantine Acheulean',
culture.A == 'Acheulean - Europe' & culture.B == 'Acheulean - Europe' ~ 'European Acheulean',
culture.A == 'Howiesonspoort' & culture.B == 'Howiesonspoort' ~ 'Howiesons Poort',
culture.A == 'Aterian' & culture.B == 'Aterian' ~ 'Aterian',
culture.A == 'Micoquian' & culture.B == 'Micoquian' ~ 'Micoquian',
culture.A == 'ELSA' & culture.B == 'ELSA' ~ 'Early Later Stone Age',
culture.A == 'Gravettian' & culture.B == 'Gravettian' ~ 'Gravettian',
culture.A == 'Initial Upper Paleolithic - Eurasia' & culture.B == 'Initial Upper Paleolithic - Eurasia' ~ 'Initial Upper Paleolithic'
)) %>%
mutate(connection = factor(connection, levels = c('African Acheulean', 'Levantine Acheulean', 'European Acheulean', 'Howiesons Poort', 'Aterian', 'Micoquian', 'Early Later Stone Age', 'Gravettian', 'Initial Upper Paleolithic'))) %>%
filter(!is.na(connection))
View(data_cultures)
write_csv(cultures, 'work/stats_all_cultures.csv')
write_csv(periods, 'work/stats_all_periods.csv')
cultures
rm(cultures)
rm(periods)
# Statistics for subsets
stats_cultures <- data_cultures %>% group_by(connection) %>%
summarize(median_dist=median(dist),
mean_dist=mean(dist),
sd_dist=sd(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
sd_jaccard=sd(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
# Statistics for subsets
stats_periods <- data_periods %>% group_by(connection) %>%
summarize(median_dist=median(dist),
mean_dist=mean(dist),
sd_dist=sd(dist),
max_dist=max(dist),
median_jaccard=median(jaccard),
mean_jaccard=mean(jaccard),
sd_jaccard=sd(jaccard),
max_jaccard=max(jaccard),
pearson=cor(jaccard, dist, method='pearson'),
kendall=cor(jaccard, dist, method='kendall'),
spearman=cor(jaccard, dist, method='spearman'))
View(stats_cultures)
View(stats_periods)
write_csv(data_periods, 'work/periods_edges.csv')
write_csv(data_cultures, 'work/cultures_edges.csv')
write_csv(data_cultures, 'work/cultures_edges.csv')
write_csv(stats_periods, 'work/stats_selected_periods.csv')
write_csv(stats_cultures, 'work/stats_selected_cultures.csv')
View(stats_periods)
View(stats_cultures)
